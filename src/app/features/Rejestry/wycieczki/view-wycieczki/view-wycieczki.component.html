<div class="h-full flex flex-col">
  <ng-container class="m-2 p-4">
    <div class="flex items-center justify-between w-full">
      <h1 class="pt-3 pl-3">Rejestr wycieczek</h1>

      <button
        mat-icon-button
        color="primary"
        class="mr-3"
        matTooltip="Masz dostęp tylko do wglądu wycieczek, nie możesz ich edytować ani usuwać."
      >
        <mat-icon>info</mat-icon>
      </button>
    </div>
  </ng-container>

  <ng-container>
    <mat-card class="m-2 p-0 flex-1 flex flex-col overflow-hidden">
      <app-loading-html *ngIf="isProgress"></app-loading-html>

      <div class="flex-1 overflow-auto">
        <table
          mat-table
          matSort
          [dataSource]="dataSource"
          class="w-full table-auto text-sm border-collapse"
        >

          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              Wycieczka
            </th>
            <td mat-cell
                *matCellDef="let element"> {{ element?.name || '-' }}
            </td>
          </ng-container>

          <ng-container matColumnDef="cel">
            <th mat-header-cell  *matHeaderCellDef mat-sort-header>
              Cel wycieczki
            </th>
            <td mat-cell
                *matCellDef="let element"> {{ element?.cel || '-' }}
            </td>
          </ng-container>

          <ng-container matColumnDef="trasa">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              Trasa wycieczki
            </th>
            <td mat-cell
                *matCellDef="let element"> {{ element?.trasa || '-' }}
            </td>
          </ng-container>

          <ng-container matColumnDef="srodek_transportu">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              Środek transportu
            </th>
            <td mat-cell
                *matCellDef="let element"> {{ element?.srodek_transportu || '-' }}
            </td>
          </ng-container>

          <ng-container matColumnDef="owner">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              Kierownik
            </th>
            <td mat-cell
                *matCellDef="let element"> {{ element?.owner || '-' }}
            </td>
          </ng-container>

          <ng-container matColumnDef="date">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              Data
            </th>
            <td mat-cell
                *matCellDef="let element"> {{ element?.date || '-' }}
            </td>
          </ng-container>

          <ng-container matColumnDef="created_at">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              Utworzono
            </th>
            <td mat-cell
                *matCellDef="let element"> {{ element?.created_at || '-' }}
            </td>
          </ng-container>

          <ng-container matColumnDef="status">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              Status
            </th>
            <td mat-cell
                *matCellDef="let element"> {{ element?.status || '-' }}
            </td>
          </ng-container>

          <ng-container matColumnDef="uczniowie">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              Ilość uczniów
            </th>
            <td mat-cell
                *matCellDef="let element"> {{ element?.uczniowie.length || '-' }}
            </td>
          </ng-container>

          <ng-container matColumnDef="opiekunowie">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              Ilość opiekunów
            </th>
            <td mat-cell
                *matCellDef="let element"> {{ element?.opiekunowie.length || '-' }}
            </td>
          </ng-container>

          <tr mat-header-row class="bg-gray-100 text-center sticky-header" *matHeaderRowDef="displayedColumns; sticky: true"></tr>
          <tr
            mat-row
            class="hover:bg-gray-100"
            *matRowDef="let row; columns: displayedColumns;"
            [ngClass]="{
              '!bg-red-100 italic': row.status === 'odrzucone.',
              '!bg-green-100': row.status === 'zatwierdzona.' || row.status === 'zatwierdzona',
              '!bg-orange-100': row.status === 'przekazana do zatwierdzenia.',
            }"
          ></tr>
        </table>

        <ng-container class="flex-1 h-full " *ngIf="dataSource.data.length == 0">
          <div class="text-center p-4 text-gray-500">
            Brak dodanych wycieczek w rejestrze.
          </div>
        </ng-container>

      </div>
    </mat-card>
  </ng-container>
</div>
